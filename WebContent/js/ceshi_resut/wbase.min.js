function incrhtml(a){var b=parseInt($(a).html());$(a).html(b+1)}function decrhtml(a){var b=parseInt($(a).html());$(a).html(b-1)}function btnsHover(a,b){var b=b?b:"act_btns";$(a).hover(function(){$(this).addClass(b)},function(){$(this).removeClass(b)})}function imgHover(){$("img[hover=true]").each(function(){var a=$(this);$(this).unbind("hover").hover(function(){a.css("opacity",.85)},function(){a.css("opacity",1)})})}function setNav(){$("#nav_list li").each(function(a){var b=$(this),c=b.find("dl");if(b.css("z-index",888-a),c.length>0){var d=b.find("a:first"),e=b.find(".mark");b.hover(function(){d.addClass("act"),c.css("display","block"),e.css({height:c.height()-7+"px",display:"block"})},function(){d.removeClass("act"),c.css("display","none"),e.css("display","none")})}})}function go2reply(a){$(window).scrollTop(1e4),$(a).focus()}function bindReplys(){$(".items .reply").click(function(){var a=$(this).parent().parent();2==a.children().length?($("#id_reply_comment_id").val(a.attr("comment_id")),a.append($("#id_reply_form")),$("#id_reply_form").show()):$("#id_reply_form").show()})}function showCommentDelete(a){if(isLogined&&loginuser.is_superuser){if(a){var b=$(a).find("a.delete");return void b.show()}var b=$("#comments_list a.delete");b.show()}}function loadComments(a,b,c,d,e){var f=$("#comments_list");e||(e="正在载入评论..."),f.html('<p class="loading"><span>'+e+"</span></p>");var g="/comment/page/?content_type="+b+"&object_id="+a+"&page="+c+"&per_page="+d+"&time="+$.now();$.get(g,function(a){f.html(a),encodeatnickname(f),imgHover()})}function encodeatnickname(a){if("string"==typeof a)return a;a.find("span.encodenickname").each(function(){var a=/@([^\s]+)/gm,b=$(this).html();b=b.replace(a,'<a href="/user/go2nickname/?nickname=$1">@$1</a> '),$(this).html(b)})}function delComment(a,b){var c=a.href+"?t="+$.now();return $.get(c,function(a){a.status&&($("#id_comment_"+b).slideUp("fast",function(){$(this).remove()}),decrhtml("#id_commentnum_"+a.object_id))}),!1}function getItemsByPage(a){return $.get(pageUrl,{p:a,t:$.now()},function(a){$("#commentlist").html(a)}),!1}function scrollToPos(a,b,c){var d=$(a),e=$(b).offset().top,c=c?c:50;d.click(function(){var a=$(document).scrollTop(),b=e>a;timer=setInterval(function(){if(b?(a+=c,a=a>=e?e:a):(a-=c,a=a<=e?e:a),window.scrollTo(0,a),!b&&a<=e||b&&a>=e)return clearTimeout(timer),!1},50)})}function setInputLen(a,b,c){var d,e=$(a),f=$(b),g={setLen:function(){var a=e.val();a.length>=c?(e.val(a.substr(0,c)),d=0):d=c-a.length,f.html(d)}};e.keyup(function(){g.setLen()}).blur(function(){g.setLen()})}function setTestSels(a,b){var c=$(a);c.hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}).click(function(){c.removeClass("act");var a=$(this).find(":radio");a.length>0&&($(this).addClass("act"),a.attr("checked","checked"),b&&b(this))})}function setFocusSlid(a,b,c,d){var e,f=$(a).find("li"),g=f.length,h=0,i=1,j=function(){var e=$(a).find("li");e.removeClass("act"),$(e[h]).addClass("act"),$(b).stop(),"h"==d?$(b).animate({scrollLeft:c*h},300):$(b).animate({scrollTop:c*h},300)},k=function(){e=setInterval(l,5e3)},l=function(){j(),0==h&&(i=1),h==g-1&&(i=-1),h+=i};f.each(function(a){$(this).hover(function(){clearInterval(e),h=a,j()},function(){k()})}),h=1,k()}function Rollable(a,b){var c=$(a).find("div.roll a"),d=$(c[0]),e=$(c[1]),f=$(a).find("div.roll span"),g=$(f[0]),h=$(f[1]),i=$(a).find("div.roll_box"),j=function(){return i.animate({scrollLeft:0},300),d.unbind(),g.unbind(),d.removeClass("lact"),h.removeClass("act"),g.addClass("act"),e.addClass("ract"),e.click(k),h.click(k),!1},k=function(){return i.animate({scrollLeft:b},300),e.unbind(),h.unbind(),e.removeClass("ract"),g.removeClass("act"),h.addClass("act"),d.addClass("lact"),d.click(j),g.click(j),!1};j()}function setDayCeshi(){var a=$("#day_sels"),b=a.find("p.items"),b=$("#day_sels .items"),c=!1;b.click(function(){b.removeClass("act"),$(this).addClass("act"),$(this).find("input").attr("checked","checked"),c=!0}),$("#id_ceshi_next").click(function(){c&&$("#id_day_ceshi_form").submit()})}function ddhover(a){$(a).find("a.back").hide(),$(a).hover(function(){$(this).find("a.back").show()},function(){$(this).find("a.back").hide()})}function delreply(a){$("#id_reply_nickname_"+a).parent().hide()}function reply(a,b,c){var d=$(a).parents("div.comments"),e=d.attr("id").split("_"),f=e[e.length-1];$("#id_reply_comment_id_"+f).val(b),$("#id_reply_nickname_"+f).html(c),$("#id_reply_nickname_"+f).parent().show()}function initcommentform(){setInputLen("#id_comment","#max_words",200),$("#id_comment_form").submit(function(){return $("#id_comment").checkinput()}),$("#id_comment_post").attr("disabled",!1)}function favSite(){var a="http://www.xinli001.com/",b="改变从这里开始 - 心理网";if(window.sidebar)window.sidebar.addPanel(b,a,"");else{if(!document.all)return!0;window.external.AddFavorite(a,b)}}function watermark(){$(":input[tip]").each(function(){$(this).watermark()})}function showNotice(a){var b=$('<a title="提示信息"></a>'),c='<p class="loading"><span>'+a+"</span></p>";b.florabox({width:250,content:c}).click()}function favorite(a){return $(a).attr("disabled",!0),$.get(a.href,{t:$.now()},function(b){switch($(a).attr("disabled",!1),b.code){case 0:alert("收藏成功");break;case-1:alert("你已经收藏过了哦");break;default:showLoginPopup(),window.loginSuccess=function(){favorite(a)}}}),!1}function changeHotCeshi(a){var b=$(a),c=b.data("url")+"?p="+b.data("page");return $.get(c,function(a){$("#id_hot_ceshi_list").html(a),b.data("page",b.data("page")+1)}),!1}function openConnectClick_qplus(a){var b=$(a).attr("href"),c=$(a).attr("title");return open(b,c),!1}function getObjView(a){return $.get(a,function(a){$("#id_obj_viewnum").html(a)}),!1}function clearCache(a,b){return $.get(a,{sec:b}),!1}function getQaVips(a){var b=$(a).attr("url")+"?per_page=5&t="+$.now();return $.get(b,function(a){$("#id_qa_vip_list").html(a)}),!1}function userRepost(a){return $(a).attr("disabled",!0),$.get(a.href,{t:$.now()},function(b){switch($(a).attr("disabled",!1),b.code){case 0:alert("转载成功");break;case-2:showLoginPopup(),window.loginSuccess=function(){userRepost(a)}}}),!1}function getValidQuestion(){var a=$("#id_seed").val();return $("#id_secquestion_img").css("visibility","hidden"),$.ajax({url:getValidQuestionUrl,data:{t:$.now(),seed:a},dataType:"jsonp",success:function(a){a.question&&$("#id_secquestion").html(a.question),a.image&&($("#id_secquestion_img").attr("src",a.image),$("#id_secquestion_img").css("visibility","visible"))}}),!1}function getValidImg(){var a=$("#id_seed").val(),b=validimgUrl+"?seed="+a+"&t="+$.now();return $("#id_secquestion_img").css("visibility","visible"),$("#id_secquestion_img").attr("src",b),!1}function showEmailActivePanel(a){return $("<a></a>").fancybox({type:"html",content:a,title:"激活账号"}).click(),!1}function resendEmailActive(a){var b=$(a).data("url");return $.get(b,{t:$.now()},function(a){switch(a.code){case 0:alert("激活邮件已发送");break;case-1:alert("你的邮箱已经激活");break;case-2:alert("操作太频繁了，休息"+a.gap+"秒")}}),!1}function activeEmailClose(){return $.fancybox.close(),!1}function getUserTips(){var a=userListenTipsUrl+"?t="+$.now(),b=$("#id_user_nickname_a").html();$.ajax({url:a,dataType:"jsonp",success:function(a){var c=a.message+a.follow+a.notice+a.answer;c>0&&$("#id_user_nickname_a").html(b+"("+c+")")}})}function startListenTips(){getUserTips()}function uploadFileOnSelectFile(a){"editor"==a&&($(".ke_uploading_msg").html(""),$(".ke_uploading_bar").show(),$(".ke_uploading_pos").width(0)),"cover"==a&&($("#id_cover_msg").html(""),$("#id_uploading_bar").show(),$("#id_uploading_pos").width(0))}function uploadFileOnTooBig(a,b){"editor"==a&&$("div.ke_upload_msg").html("图片大小不能超过1M，请压缩后再上传"),"cover"==a&&$("#id_cover_msg").html("图片大小不能超过1M，请压缩后再上传")}function uploadFileOnProgress(a,b,c){"editor"==a&&$(".ke_uploading_pos").width(b/c*300),"cover"==a&&$("#id_uploading_pos").width(b/c*380)}function uploadFileOnUploadCompleteData(a,b){"editor"==a&&($('.ke-input-text[name="localUrl"]').val(b),$(".ke_uploading_bar").hide()),"cover"==a&&($("#id_cover").val(b),$("#id_uploading_bar").hide())}function uploadFileOnReady(a){"cover"==a&&$("#id_upload_button").show()}function bindCopydeny(){$("body").bind("copy",function(){return!!_isstaff||($('<a href="#copydeny"></a>').fancybox().click(),!1)})}function showLoginPopup(){$('<a href="#login_popup"></a>').fancybox({modal:!0}).click(),$("#login_popup a.lpclose").click(function(){return $.fancybox.close(),!1})}function loginPopupFormSubmit(){var a=$.trim($("#lp_username").val()),b=$.trim($("#lp_password").val());if(""==a)return alert("请输入登录邮箱"),!1;if(""==b)return alert("请输入登录密码"),!1;$("#lp_submit").val("提交中..."),$("#lp_submit").disable();var c=$("#lp_form").attr("action"),d=$("#lp_form").serialize();return $.ajax({url:c,data:d,dataType:"jsonp",success:function(a){switch($("#lp_submit").val("提交"),$("#lp_submit").enable(),a.code){case 0:$.fancybox.close(),window.loginSuccess&&window.loginSuccess.apply();break;case-1:alert("用户名或密码不正确")}}}),!1}function setTopbar(a){var b,c=$("#topbar"),d=(c.find("a"),/MSIE 6.0/gi.test(navigator.appVersion)),e=document.documentElement.clientWidth;a||(a=0),b=Math.round((e-960)/2)+320-33,c.css("right",b+"px"),$(window).bind("scroll",function(){var b,e,f=document.documentElement.clientWidth,g=parseInt(document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop);g>a&&f>=960?(c.fadeIn(),d&&(b=document.documentElement.clientHeight,e=b-70+g+"px",c.stop().animate({top:e},"slow"))):c.fadeOut()}),$(window).bind("resize",function(){var a,b=document.documentElement.clientWidth;b<960?c.fadeOut():(a=Math.round((b-960)/2)+320-33,c.show().css("right",a+"px"))})}function setAppMenu(){var a=$("#appmenu"),b=a.find(".menuicon"),c=b.find(".hot"),d=!1;b.bind("click",function(){var b=null;d||(c.hide(),d=!0),a.addClass("appmenu_hover"),a.bind("mouseover",function(){b&&clearTimeout(b),$(this).addClass("appmenu_hover")}).bind("mouseout",function(){var a=$(this);b=setTimeout(function(){a.removeClass("appmenu_hover").unbind("mouseover mouseout")},200)})})}function hideSiteTip(){return $.ajax({url:"http://www.xinli001.com/user/hidesitetip/",dataType:"jsonp"}),$("#siteTip").hide(),!1}function getUserInfo(){return void 0!=window.USER_TIPS_URL&&($.ajax({url:USER_TIPS_URL,dataType:"jsonp",success:function(a){$("#userinfospan").html(a.data)}}),!1)}function sharetobaidusns(a,b,c,d,e){var f=a.target,g=a.pageX,h=a.pageY,i=1,j=1,k=1,l=1,a=1,m=Math.floor(f.offsetWidth),n=Math.floor(f.offsetHeight),o=1,p=+new Date;p=4706;var q=[g,h,i,j,k,l,a,m,n,o,p].join("."),r="";"tsina"==b&&(r="2165055798",c=e);var s={to:b,title:c,url:d,pic:"",key:r,firstime:J.getCookie("bdshare_firstime"),t:Math.random(),sloc:q,desc:e},t=$.param(s),d=bdshareurl+bdsharep+"&"+t;return window.open(d),setTimeout(function(){(new Image).src=bdshareurl+"commit"+bdsharep+"&"+t},1500),!1}var isLogined=!1,loginuser,userAgent=navigator.userAgent,mreg=/iphone|android|ipad|mobile/i,isMobile=mreg.test(userAgent),tipsInterval,tipsmsec=1e4,failTimes=0,lastMessageNum=lastFollowNum=lastNoticeNum=lastAnswerNum=0,J={_isCookieValidKey:function(a){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(a)},getCookieRaw:function(a){if(J._isCookieValidKey(a)){var b=new RegExp("(^| )"+a+"=([^;]*)(;|$)"),c=b.exec(document.cookie);if(c)return c[2]||null}return null},setCookieRaw:function(a,b,c){if(J._isCookieValidKey(a)){c=c||{};var d=c.expires;"number"==typeof c.expires&&(d=new Date,d.setTime(d.getTime()+c.expires)),document.cookie=a+"="+b+(c.path?"; path="+c.path:"")+(d?"; expires="+d.toGMTString():"")+(c.domain?"; domain="+c.domain:"")+(c.secure?"; secure":"")}},getCookie:function(a){var b=J.getCookieRaw(a);return"string"==typeof b?b=decodeURIComponent(b):null},setCookie:function(a,b,c){J.setCookieRaw(a,encodeURIComponent(b),c)}},bdshareurl="http://s.share.baidu.com/",bdsharep="?click=1&uid=603462&type=text&relateUid=&sign=on&comment=&searchPic=0&l=180v51iuo180v51ju2180v5n4oh&linkid=hjv6hviw77o&sloc=&apiType=0&buttonType=1";$(function(){watermark(),btnsHover(".btns"),imgHover(),setAppMenu(),getUserInfo(),$("#lp_form").submit(loginPopupFormSubmit),$("#lp_form .rpart a").click(function(){$.fancybox.close()}),$(document).ajaxStart(function(){try{$.fancybox.showLoading()}catch(a){}}),$(document).ajaxComplete(function(){try{$.fancybox.hideLoading()}catch(a){}}),$(document).ajaxError(function(){window.ajaxErrorHandler&&window.ajaxErrorHandler.call(this)})});