function setFocusSlid(a, b, c, d) {
    var e, f = $(a).find("li"), g = f.length, h = 0, i = 1, j = function () {
        var e = $(a).find("li");
        e.removeClass("act"), $(e[h]).addClass("act"), $(b).stop(), "h" == d ? $(b).animate({scrollLeft: c * h}, 300) : $(b).animate({scrollTop: c * h}, 300)
    }, k = function () {
        e = setInterval(l, 5e3)
    }, l = function () {
        j(), 0 == h && (i = 1), h == g - 1 && (i = -1), h += i
    };
    f.each(function (a) {
        $(this).hover(function () {
            clearInterval(e), h = a, j()
        }, function () {
            k()
        })
    }), h = 1, k()
}
function bindUserinfoToggle() {
    $("#user_info_toggle").click(function () {
        return $("#user_announce_wrap").hide(), $("#user_info_wrap").toggle(), !1
    }), $("#user_announce_toggle").click(function () {
        return $("#user_info_wrap").hide(), $("#user_announce_wrap").toggle(), $(this).find("span").length > 0 && ($(this).find("span").remove(), $.get($(this).data("url"))), !1
    }), $("#userinfoSpan .un_btn_clear").click(function () {
        var a = {};
        a.t = $.now();
        var b = $(this).attr("href");
        return $.get(b, a, function (a) {
            $("#user_announce_wrap .un_list").hide(), $("#user_announce_wrap .un_list_clear").show(), $("#user_announce_toggle span").remove()
        }), !1
    }), $(".ud_list li").radio({eventName: "mouseover", active: "active"})
}
function getUserinfo() {
    var a = {};
    a.t = $.now();
    var b = userinfoUrl;
    $.ajax({
        url: b, data: a, dataType: "jsonp", success: function (a) {
            $("#userinfoSpan").html(a.data), bindUserinfoToggle()
        }
    })
}
function userFollowClick() {
    var a = $(this);
    if (a.hasClass("focus_OK") && !window.confirm("确定取消关注吗？"))return !1;
    if (a.data("lock"))return !1;
    a.data("lock", !0);
    var b = a.attr("href");
    return $.get(b, {t: $.now()}, function (b) {
        switch (a.data("lock", !1), b.code) {
            case 0:
                incrhtml($("#fansnumA")), a.addClass("focus_OK"), a.removeClass("focus_Go"), a.html("已关注");
                break;
            case 1:
                decrhtml($("#fansnumA")), a.addClass("focus_Go"), a.removeClass("focus_OK"), a.html("我要关注");
                break;
            case-1:
                showLoginPopup(), window.loginSuccess = function () {
                    userFollowClick.call(a)
                }
        }
    }), !1
}
function userFollowsItemClick() {
    var a = $(this);
    if (a.hasClass("cancel_btn") && !window.confirm("确定取消关注吗？"))return !1;
    if (a.data("lock"))return !1;
    a.data("lock", !0);
    var b = a.attr("href");
    return $.get(b, {t: $.now()}, function (b) {
        switch (a.data("lock", !1), b.code) {
            case 0:
                a.addClass("cancel_btn"), a.html("取消关注");
                break;
            case 1:
                a.removeClass("cancel_btn"), a.html("关注TA");
                break;
            case-1:
                showLoginPopup(), window.loginSuccess = function () {
                    userFollowsItemClick.call(a)
                }
        }
    }), !1
}
function favoriteClick() {
    var a = $(this);
    if (a.data("lock"))return !1;
    a.data("lock", !0);
    var b = a.attr("href");
    return $.get(b, {t: $.now()}, function (b) {
        switch (a.data("lock", !1), b.code) {
            case 0:
                slidemsg("喜欢成功"), incrhtml(a), a.addClass("photo_liked");
                break;
            case 1:
                slidemsg("取消喜欢成功"), decrhtml(a), a.removeClass("photo_liked");
                break;
            case-1:
                showLoginPopup(), window.loginSuccess = function () {
                    favoriteClick.call(a)
                }
        }
    }), !1
}
function removeClick() {
    if (!confirm("确定删除吗"))return !1;
    var a = $(this).attr("href");
    return $.get(a, {t: $.now()}, function (a) {
        window.location = a.next
    }), !1
}
function commentDelete() {
    if (!window.confirm("确定删除吗？"))return !1;
    var a = $(this), b = a.data("pk"), c = a.attr("href"), d = {t: $.now(), pk: b};
    return $.get(c, d), $("#item" + b).slideUp(), !1
}
function userArticleTop() {
    var a = $(this), b = a.data("pk");
    if ($("#item" + b).find("p.title").hasClass("top") && !window.confirm("确定取消置顶吗？"))return !1;
    var c = a.attr("href"), d = {t: $.now()};
    return $.get(c, d, function () {
        location.reload()
    }), !1
}
function tagClick() {
    for (var a = $(this).html(), b = $.trim($("#tags").val()), c = b.split(" "), d = 0; d < c.length; d++) {
        if (c[d] == a)return !1
    }
    return $("#tags").val(b + " " + a), !1
}
function checkUserPostform() {
    var a = $(this);
    parseInt($(this).find("input[name=id]").val());
    if ("" == $.trim($("#title").val()))return slidemsg("请输入日志标题"), $("#title").focus(), !1;
    if (!editor.hasContents())return slidemsg("请输入内容"), editor.focus(), !1;
    var b = (editor.getContent(), $.trim($("#tags").val()));
    if ("" == b)return slidemsg("请输入日志标签"), $("#tags").focus(), !1;
    if (b.split(" ").length > 5)return slidemsg("日志标签最多5个"), $("#tags").focus(), !1;
    if ("" == $("#verifycode").val())return slidemsg("请输入验证码"), $("#verifycode").focus(), !1;
    var c = $(this).find("input:submit");
    c.val("提交中..."), c.attr("disabled", !0);
    var d = a.serialize(), e = a.attr("action");
    return $.post(e, d, function (a) {
        switch (a.code) {
            case-1:
                slidemsg("验证码不正确"), getValidCode(), c.val("发表日志"), c.attr("disabled", !1);
                break;
            case-2:
                slidemsg("表单填写不完整"), c.val("发表日志"), c.attr("disabled", !1);
                break;
            default:
                location.href = a.next
        }
    }), !1
}
function jubaoClick() {
    if (!confirm("确定举报它？"))return !1;
    var a = $(this), b = a.data("pk"), c = a.data("cls"), d = {t: $.now(), pk: b, cls: c}, e = a.attr("href");
    return $.get(e, d, function (b) {
        switch (b.code) {
            case-1:
                showLoginPopup(), window.loginSuccess = function () {
                    jubaoClick.call(a)
                };
                break;
            case-2:
                slidemsg("你已经举报过了哦");
                break;
            case 0:
                slidemsg("感谢你的举报")
        }
    }), !1
}
function initJubaoClick() {
    $(this).find("a.jubao").click(jubaoClick)
}
function initOtherComment() {
    var a = $(this);
    a.find("a.delete_btn").click(commentDelete), a.find("a.reply_btn").click(function () {
        return a.find("form").toggle(), !1
    }), a.find("form").submit(checkCommentForm), initJubaoClick.call(a), a.hover(function () {
        a.find("span.comment_opt").show()
    }, function () {
        a.find("span.comment_opt").hide()
    })
}
function checkCommentForm() {
    var a = $(this);
    if (a.data("lock"))return !1;
    var b = a.find("textarea");
    if ("" == $.trim(b.val()))return slidemsg("请输入评论内容"), b.focus(), !1;
    a.data("lock", !0);
    var c = a.find(":submit"), d = c.val();
    c.val("提交中");
    var e = a.attr("action"), f = a.serialize();
    return $.post(e, f, function (e) {
        switch (a.data("lock", !1), c.val(d), e.code) {
            case-1:
                showLoginPopup(), window.loginSuccess = function () {
                    checkCommentForm.call(a)
                };
                break;
            case 0:
                var f = $(e.data);
                $("#commentListUl").prepend(f), initOtherComment.call(f), b.val(""), slidemsg("评论成功"), a.hasClass("reply_form") && (a.hide(), $("#commentsA").click())
        }
    }), !1
}
function checkMessageForm() {
    var a = $(this);
    if (a.data("lock"))return !1;
    if ("" == a.find("textarea").val())return alert("请输入私信内容"), !1;
    a.data("lock", !0);
    var b = a.attr("action"), c = a.serialize();
    return $.post(b, c, function (b) {
        switch (a.data("lock", !1), b.code) {
            case-1:
                showLoginPopup(), window.loginSuccess = function () {
                    checkMessageForm.call(a)
                };
                break;
            case 0:
                slidemsg("私信已发送")
        }
    }), !1
}
function userShowWarning(a, b) {
    var c = $(a).parent();
    c.find("span.warning").html(b), c.find("span.warning").show(), c.find("span.correct").hide()
}
function userShowCorrect(a) {
    var b = $(a).parent();
    b.find("span.warning").html(""), b.find("span.warning").hide(), b.find("span.correct").show()
}
function checkUserSettingIndexForm() {
    var a = $(this);
    if (a.data("lock"))return !1;
    $.validity.start();
    var b = /^[\u4e00-\u9fa5\w-]{2,20}$/;
    if ($("#nickname").require().match(b, "昵称的长度为2-20个中文、数字或英文字母"), $("input[name=gender]").radioNotChecked(void 0, "请选择性别"), $("#year").require("请选择出生日期"), $("#month").require("请选择出生日期"), $("#day").require("请选择出生日期"), $("#province").require("请选择居住地"), $("#city").require("请选择居住地"), $("#honor").maxLength(20, "请限制在20个字符以内"), $("#introduce").maxLength(120, "请限制在120个字符以内"), !$.validity.end().valid)return !1;
    a.data("lock", !0);
    var c = a.find("input:submit"), d = c.val();
    c.val("提交中..."), $("#birthday").val($("#year").val() + "-" + $("#month").val() + "-" + $("#day").val());
    var e = $("#nickname").val();
    if ($("#nickname").data("nickname") != e) {
        var f = {nickname: e, t: $.now()};
        $.get(checkNicknameUrl, f, function (b) {
            if (b.code == -1) a.data("lock", !1), c.val(d), userShowWarning($("#nickname"), "你的昵称太受欢迎，已有人抢了"); else {
                var e = a.attr("action"), f = a.serialize();
                $.post(e, f, function (b) {
                    a.data("lock", !1), c.val(d), 0 == b.code ? slidemsg("保存成功") : slidemsg("保存失败")
                })
            }
        })
    } else {
        var g = a.attr("action"), f = a.serialize();
        $.post(g, f, function (b) {
            0 == b.code ? slidemsg("保存成功") : slidemsg("保存失败"), a.data("lock", !1), c.val(d)
        })
    }
    return !1
}
function checkUserSettingPasswordForm() {
    var a = $(this);
    if (a.data("lock"))return !1;
    if ($.validity.start(), $("#old_password").require(), $("#new_password1").require().maxLength(20).minLength(6), $("input.new_password").equal("两次密码输入不正确"), !$.validity.end().valid)return !1;
    a.data("lock", !0);
    var b = a.find("input:submit"), c = b.val();
    b.val("提交中...");
    var d = a.attr("action"), e = a.serialize();
    return $.post(d, e, function (d) {
        0 == d.code ? (slidemsg("密码修改成功"), $("#old_password").val(""), $("#new_password1").val(""), $("#new_password2").val("")) : slidemsg("原始密码不正确"), a.data("lock", !1), b.val(c)
    }), !1
}
function checkUserOptionAvatarForm() {
    var a = $(this);
    return !a.data("lock") && (a.data("lock", !0), !1)
}
function checkUserMessageForm() {
    var a = $(this);
    if (a.data("lock"))return !1;
    var b = a.find("textarea");
    if (content = b.val(), "" == content)return slidemsg("请输入私信内容"), b.focus(), !1;
    a.data("lock", !0);
    var c = a.find("input:submit");
    c.val();
    c.val("发送中...");
    var d = a.attr("action"), e = a.serialize();
    return $.post(d, e, function (c) {
        a.data("lock", !1), 0 == c.code ? (slidemsg("私信发送成功"), b.val(""), $("#listUl").prepend(c.data)) : slidemsg("私信发送失败")
    }), !1
}
function userSnsBindClick() {
    var a = $(this);
    if (a.data("lock"))return !1;
    var b = a.attr("href"), c = a.parent(), d = c.find("span");
    if (c.hasClass("unbind")) {
        if (!window.confirm("确定取消绑定吗？"))return !1;
        a.data("lock", !0);
        var e = {};
        e.unbind = 1, e.t = $.now(), $.get(b, e, function (b) {
            a.data("lock", !1), slidemsg("已取消绑定"), c.removeClass("unbind"), d.html("未" + d.html().substr(1)), a.html("绑定账号")
        })
    } else window.snsBindFinish = function (b) {
        0 == b ? (slidemsg("绑定成功"), d.html("已" + d.html().substr(1)), c.addClass("unbind"), a.html("取消绑定")) : slidemsg("绑定失败")
    }, window.open(b);
    return !1
}
function initUserArticlePage() {
    $("#commentForm").submit(checkCommentForm), $("#postLikeA").click(favoriteClick), $("#postDelA").click(removeClick), $("#commentListUl li").each(function () {
        initOtherComment.call($(this))
    })
}
function initUserArticlePostPage() {
    editor = UM.getEditor("content", {toolbar: window.UMEDITOR_CONFIG.mintoolbar2}), $("#taglist a").click(tagClick), $("#postForm").submit(checkUserPostform), getValidCode()
}
function userDetailHOver(a) {
    a ? $(this).addClass("user_det_act") : $(this).removeClass("user_det_act")
}
function userFaceHOver(a) {
    a ? $(this).addClass("user_face_act") : $(this).removeClass("user_face_act")
}
function initUserPage() {
    $("a.follow_user_btn").click(userFollowClick), $("#messageForm").submit(checkMessageForm), $("#messageA").popup(), $("#listUl li").hover(function () {
        $(this).find(".item_hover").show()
    }, function () {
        $(this).find(".item_hover").hide()
    }), $("a.item_del").click(commentDelete), $("a.item_top").click(userArticleTop)
}
function initUserOptionIndexPage() {
    var a = $("#birthday").val(), b = 0;
    a.length > 0 && (b = a.split("-"), b[0] = parseInt(b[0]), b[1] = parseInt(b[1]), b[2] = parseInt(b[2])), $.dateSelector({
        selYear: "year",
        selMonth: "month",
        selDay: "day",
        initD: b
    }), $.validity.setup({outputMode: "usertip"}), $("#settingForm").submit(checkUserSettingIndexForm)
}
function initUserOptionPasswordPage() {
    $.validity.setup({outputMode: "usertip"}), $("#passwordForm").submit(checkUserSettingPasswordForm)
}
function initUserOptionSnsBindPage() {
    $(".bind_setting a.btn").click(userSnsBindClick)
}
function initUserOptionAvatarPage() {
    $("#avatar").change(function () {
        $("#avatarForm").submit(), $(this).attr("disabled", !0)
    })
}
function initUserMessageShowPage() {
    $("#messageForm").submit(checkUserMessageForm)
}
function initUserFollowPage() {
    $("#listUl a.foucus_btn").click(userFollowsItemClick)
}
function bindIndex() {
    $(".xinlizz .txt_box li").radio({
        eventName: "mouseover",
        active: "active"
    }), $(".xinliSite").btnSwitcher({
        active: "act",
        activeList: ["lact", "ract"]
    }), $(".xinliFm").btnSwitcher({
        active: "act",
        activeList: ["lact", "ract"]
    }), $("#xinliAction").hroll({active: "act"}), $(".weixin a").mouseover(function () {
        $(".focus_weixin").show()
    }), $(".weixin a").mouseout(function () {
        $(".focus_weixin").hide()
    }), $(".mobile a").mouseover(function () {
        $(".focus_mobile").show()
    }), $(".mobile a").mouseout(function () {
        $(".focus_mobile").hide()
    }), $("a.dingyuea").click(function () {
        return !1
    }), $("#xinlizz_pic_scroll").fishslider({current: "act"}), $(".xinli_preview .content_wrap li").radio({
        eventName: "mouseover",
        active: "act"
    })
}
function changeHotCeshi(a) {
    var b = $(a), c = b.data("url") + "?page=" + b.data("page");
    return $.get(c, function (a) {
        $("#id_hot_ceshi_list").html(a), b.data("page", b.data("page") + 1)
    }), !1
}
getUserinfo(), void 0 != window.pagename && ("index" == pagename && bindIndex(), "user_article" == pagename && initUserArticlePage(), "user" == pagename && initUserPage(), "user_article_post" == pagename && initUserArticlePostPage(), "user_option_index" == pagename && initUserOptionIndexPage(), "user_option_snsbind" == pagename && initUserOptionSnsBindPage(), "user_option_password" == pagename && initUserOptionPasswordPage(), "user_option_avatar" == pagename && initUserOptionAvatarPage(), "user_message_show" == pagename && initUserMessageShowPage(), "user_follows" == pagename && initUserFollowPage());